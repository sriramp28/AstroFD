\documentclass[11pt]{article}
\usepackage{geometry}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{longtable}
\usepackage{makecell}
\geometry{margin=1in}

\title{AstroFD: Relativistic Jet and SN-lite Solver}
\author{AstroFD Contributors}
\date{\today}

\begin{document}
\maketitle

\begin{abstract}
AstroFD is a finite-volume solver for relativistic hydrodynamics and
magnetohydrodynamics in flat spacetime and on fixed curved backgrounds.
The code targets relativistic jet simulations and SN-lite core-collapse
scenarios with configurable nozzle injection, GLM divergence cleaning,
causal dissipation, two-temperature relaxation, non-ideal MHD extensions,
H/He non-equilibrium chemistry, and parametric neutrino heating. This
report provides full governing equations, variable definitions, numerical
procedures, and validation workflows for reproducible research.
\end{abstract}

\section{Introduction}
Relativistic jets and core-collapse flows exhibit strong shocks, large
Lorentz factors, magnetic stresses, and stiff source terms. AstroFD is
built as a modular research code for controlled studies of these regimes.
It combines robust conservative discretizations with optional high-order
reconstruction and flexible physics modules.

\section{Physical Background and Literature}
Relativistic jet modeling relies on SRHD and RMHD formulations for
ultrarelativistic flows, shocks, and magnetic stresses
\cite{marti1999, anile1989, komissarov1999}. GRHD/GRMHD is commonly
expressed using the Valencia 3+1 split \cite{banyuls1997, font2008}
with widely used astrophysical implementations such as HARM and ECHO
\cite{gammie2003, delzanna2007}. Divergence control in MHD is essential;
GLM cleaning provides a robust hyperbolic/parabolic mechanism
\cite{dedner2002, mignone2010}.

High-order reconstruction methods such as PPM and WENO improve accuracy in
smooth regions while maintaining stability across discontinuities
\cite{colella1984, jiang1996}. SSPRK time integration provides strong
stability-preserving updates for hyperbolic systems \cite{gottlieb2001}.

SN-lite physics uses parametric heating and cooling models motivated by
core-collapse supernova literature \cite{janka2001, janka2012}. Causal
relativistic dissipation follows Israel--Stewart-type formulations
\cite{israel1979, rezolla2013}. Resistive and non-ideal MHD extend ideal
models for controlled exploration of reconnection and drift physics
\cite{palenzuela2009}.

\section{Notation and Variables}
We use units with $c = 1$ and metric signature $(-,+,+,+)$. Greek indices
represent spacetime components and Latin indices represent spatial
components. The 4-velocity is $u^\mu$, Lorentz factor is
$W = (1 - v^2)^{-1/2}$, and the specific enthalpy is
$h = 1 + e + p/\rho$. The ideal-gas EOS is $p = (\gamma - 1) \rho e$.

\begin{table}[ht]
\centering
\begin{tabular}{l l}
\hline
Symbol & Meaning \\
\hline
$\rho$ & rest-mass density \\
$e$ & specific internal energy \\
$p$ & thermal pressure \\
$u^\mu$ & 4-velocity \\
$v^i$ & 3-velocity \\
$W$ & Lorentz factor \\
$h$ & specific enthalpy \\
$T^{\mu\nu}$ & stress-energy tensor \\
$B^i$ & magnetic field (lab frame) \\
$b^\mu$ & magnetic 4-vector \\
$\alpha$ & lapse \\
$\beta^i$ & shift \\
$\gamma_{ij}$ & spatial metric \\
$\gamma$ & determinant of $\gamma_{ij}$ \\
$\psi$ & GLM cleaning scalar \\
$\Pi$ & bulk viscous pressure \\
$\pi^{\mu\nu}$ & shear stress \\
$q^\mu$ & heat flux \\
\hline
\end{tabular}
\caption{Notation used in the governing equations.}
\label{tab:notation}
\end{table}

\section{Governing Equations}
\subsection{SRHD: Conservation Laws}
The covariant SRHD equations are
\begin{align}
\nabla_\mu (\rho u^\mu) &= 0, \\
\nabla_\mu T^{\mu\nu} &= 0,
\end{align}
with stress-energy tensor
\begin{equation}
T^{\mu\nu} = \rho h u^\mu u^\nu + p g^{\mu\nu}.
\end{equation}
In 3+1 form, the conserved variables are
\begin{align}
D &= \rho W, \\
S_i &= \rho h W^2 v_i, \\
\tau &= \rho h W^2 - p - D,
\end{align}
and the evolution equation is
\begin{equation}
\partial_t U + \partial_i F^i(U) = S(U),
\end{equation}
where $U = (D, S_i, \tau)$, $F^i$ are the conservative fluxes, and $S$
contains physical source terms (zero for flat SRHD).

\subsection{RMHD: Ideal MHD and GLM Cleaning}
Ideal RMHD satisfies
\begin{align}
\nabla_\mu (\rho u^\mu) &= 0, \\
\nabla_\mu T^{\mu\nu} &= 0, \\
\nabla_\mu {^*F}^{\mu\nu} &= 0,
\end{align}
with stress-energy tensor
\begin{equation}
T^{\mu\nu} = (\rho h + b^2) u^\mu u^\nu + \left(p + \frac{b^2}{2}\right) g^{\mu\nu} - b^\mu b^\nu,
\end{equation}
where $b^\mu$ is the magnetic 4-vector and $b^2 = b^\mu b_\mu$.
Divergence control is enforced by GLM cleaning
\cite{dedner2002, mignone2010}:
\begin{align}
\partial_t \mathbf{B} + \nabla \times \mathbf{E} + \nabla \psi &= 0, \\
\partial_t \psi + c_h^2 \nabla \cdot \mathbf{B} &= -c_p^2 \psi.
\end{align}

\subsection{GRHD/GRMHD: Valencia Formulation}
For fixed backgrounds, we adopt a 3+1 split with lapse $\alpha$, shift
$\beta^i$, and spatial metric $\gamma_{ij}$. The conservative update is
\begin{equation}
\partial_t (\sqrt{\gamma} U) + \partial_i (\sqrt{\gamma} F^i) = \sqrt{\gamma} S,
\end{equation}
with conserved variables
\begin{align}
D &= \rho W, \\
S_i &= (\rho h + b^2) W^2 v_i - \alpha b^0 b_i, \\
\tau &= (\rho h + b^2) W^2 - \left(p + \frac{b^2}{2}\right) - D - (\alpha b^0)^2.
\end{align}
Metric source terms are computed from the fixed background.

\subsubsection{Valencia Fluxes and Sources}
The Valencia formulation expresses the GRHD/GRMHD system as
\begin{equation}
\partial_t (\sqrt{\gamma} U) + \partial_i (\sqrt{\gamma} F^i) = \sqrt{\gamma} S,
\end{equation}
where $U = (D, S_j, \tau)$ and $F^i$ are
\begin{align}
F^i_D &= D (\alpha v^i - \beta^i), \\
F^i_{S_j} &= S_j (\alpha v^i - \beta^i) + \alpha \left(p + \frac{b^2}{2}\right)\delta^i{}_j - \alpha b^i b_j, \\
F^i_{\tau} &= \tau (\alpha v^i - \beta^i) + \alpha \left(p + \frac{b^2}{2}\right) v^i - \alpha b^0 b^i.
\end{align}
The source terms are
\begin{align}
S_D &= 0, \\
S_{S_j} &= \frac{\alpha}{2} T^{\mu\nu} \partial_j g_{\mu\nu}, \\
S_{\tau} &= \alpha \left(T^{\mu 0} \partial_\mu \ln \alpha - T^{\mu\nu} \Gamma^0_{\mu\nu}\right),
\end{align}
where $\Gamma^\alpha_{\mu\nu}$ are the Christoffel symbols.\\
AstroFD uses fixed analytic metrics (Minkowski, Schwarzschild, Kerr-Schild)
and computes these source terms from the prescribed background.

\paragraph{Magnetic 4-vector relations.}
In ideal RMHD, the lab-frame magnetic field $B^i$ and 4-vector $b^\mu$ are
related by
\begin{align}
b^0 &= W (B^i v_i), \\
b^i &= \frac{B^i}{W} + b^0 v^i,
\end{align}
and the ideal electric field satisfies $\mathbf{E} = -\mathbf{v} \times \mathbf{B}$.

\subsection{Causal Dissipation}
Israel--Stewart-type causal dissipation evolves bulk pressure $\Pi$,
shear stress $\pi^{\mu\nu}$, and heat flux $q^\mu$ with relaxation
\cite{israel1979, rezolla2013}:
\begin{align}
\tau_\Pi u^\alpha \nabla_\alpha \Pi + \Pi &= -\zeta \nabla_\alpha u^\alpha, \\
\tau_\pi u^\alpha \nabla_\alpha \pi^{\mu\nu} + \pi^{\mu\nu} &= 2 \eta \sigma^{\mu\nu}, \\
\tau_q u^\alpha \nabla_\alpha q^\mu + q^\mu &= -\kappa T \Delta^{\mu\nu} \nabla_\nu T.
\end{align}

\subsection{Two-Temperature Relaxation}
Electron and ion internal energies evolve with relaxation time $\tau_{ei}$:
\begin{align}
\partial_t (\rho e_e) + \nabla \cdot (\rho e_e \mathbf{v}) &= \rho \frac{e_i - e_e}{\tau_{ei}}, \\
\partial_t (\rho e_i) + \nabla \cdot (\rho e_i \mathbf{v}) &= \rho \frac{e_e - e_i}{\tau_{ei}}.
\end{align}

\subsection{H/He Non-Equilibrium Chemistry}
Species mass fractions $X_s$ satisfy
\begin{equation}
\partial_t (\rho X_s) + \nabla \cdot (\rho X_s \mathbf{v}) = \rho \dot{X}_s.
\end{equation}
The code uses collisional ionization and case-B recombination rates with
IMEX updates, following standard fits \cite{cen1992}.

\subsection{Passive Tracers}
Passive tracers $C_k$ obey
\begin{equation}
\partial_t (\rho C_k) + \nabla \cdot (\rho C_k \mathbf{v}) = 0,
\end{equation}
with inlet and ambient values set by configuration.

\subsection{Resistive and Non-Ideal MHD}
Resistive MHD uses Ohm's law
\begin{equation}
\mathbf{E} + \mathbf{v} \times \mathbf{B} = \eta \mathbf{J},
\end{equation}
with $\mathbf{J} = \nabla \times \mathbf{B}$. Optional Hall and ambipolar
corrections are included as explicit terms for controlled experiments
\cite{palenzuela2009}.

\subsection{SN-lite Gravity}
Newtonian gravity is applied as a source term with
\begin{equation}
\mathbf{g} = -G M(r) \frac{\mathbf{r}}{(r^2 + \epsilon^2)^{3/2}},
\end{equation}
using point-mass or monopole $M(r)$ options. Optionally, energy coupling
adds a pressure work term proportional to $\rho \mathbf{v} \cdot \mathbf{g}$.

\subsection{SN-lite Gain Heating/Cooling}
The gain model applies pressure updates
\begin{equation}
\Delta p = (\gamma - 1) (Q^+ - Q^-) \, \mathcal{W}(r) \, \mathcal{S}(\rho, p, t) \, \Delta t,
\end{equation}
with a radial weight $\mathcal{W}(r)$ and scaling $\mathcal{S}$. Implemented
radial weights include:
\begin{align}
\mathcal{W}_{\mathrm{sph}} &= \left(1 + \xi^2\right)^{-1}, \quad \xi = \frac{r - r_0}{r_1}, \\
\mathcal{W}_{\mathrm{pow}} &= \left(\frac{r_0}{r}\right)^{p}, \\
\mathcal{W}_{\mathrm{exp}} &= \exp\left(-\frac{|r - r_0|}{r_1}\right), \\
\mathcal{W}_{\mathrm{gauss}} &= \exp\left(-\left(\frac{r - r_0}{r_1}\right)^2\right).
\end{align}
Density and pressure scalings use optional exponents, and a time decay
factor $\exp[-(t - t_0)/\tau]$ can be applied.

\subsection{SN-lite Neutrino Lightbulb}
The lightbulb model applies a heating/cooling term using
\begin{align}
F_\nu &= \frac{L_\nu}{4 \pi r^2}, \\
\tau_{\mathrm{eff}} &= \max(\tau_0, \kappa \rho r), \\
Q^+ &= C_{\mathrm{abs}} F_\nu \epsilon_\nu e^{-\tau_{\mathrm{eff}}} \, \mathcal{W}(r), \\
Q^- &= C_{\mathrm{cool}} \rho T^{n},
\end{align}
with the same radial weight $\mathcal{W}(r)$ and optional time decay.

\subsection{Radiation--Plasma Coupling}
Optional radiation coupling relaxes the gas temperature toward $T_{\rm rad}$:
\begin{equation}
\frac{dT}{dt} = -\lambda (T - T_{\rm rad}),
\end{equation}
with $T \approx p/\rho$ in code units and a configurable coupling rate.

\section{Numerical Methods}
\subsection{Finite-Volume Discretization}
We update cell-averaged conserved variables on a Cartesian mesh with
ghost zones. The semi-discrete update is
\begin{equation}
\frac{d U_{i,j,k}}{dt} = -\frac{F^x_{i+1/2,j,k} - F^x_{i-1/2,j,k}}{\Delta x}
-\frac{F^y_{i,j+1/2,k} - F^y_{i,j-1/2,k}}{\Delta y}
-\frac{F^z_{i,j,k+1/2} - F^z_{i,j,k-1/2}}{\Delta z} + S_{i,j,k}.
\end{equation}
The timestep is set by a CFL constraint
\begin{equation}
\Delta t = C_{\mathrm{CFL}} \min\left(\frac{\Delta x}{a_{\max}}, \frac{\Delta y}{a_{\max}}, \frac{\Delta z}{a_{\max}}\right),
\end{equation}
where $a_{\max}$ is the maximum signal speed.

\subsection{Reconstruction}
Primitive variables are reconstructed to cell faces. MUSCL uses a limited
slope
\begin{equation}
\Delta q_i = \phi(\Delta q_{i-1/2}, \Delta q_{i+1/2}),
\end{equation}
with MC/minmod/van Leer limiters. PPM and WENO5 are available for higher
order accuracy \cite{colella1984, jiang1996}.

\subsection{Riemann Solvers}
HLLE provides a robust baseline. HLLC is used for hydro, and HLLD/full
HLLD for RMHD \cite{toro1999, miyoshi2005}. The solver is selected at
runtime.

\subsection{Time Integration}
We support SSPRK2 and SSPRK3 integration \cite{gottlieb2001}.
SSPRK2 uses
\begin{align}
U^{(1)} &= U^n + \Delta t L(U^n), \\
U^{n+1} &= \frac{1}{2} U^n + \frac{1}{2} \left(U^{(1)} + \Delta t L(U^{(1)})\right).
\end{align}

\subsection{Source Term Coupling and IMEX}
Source terms are applied with operator splitting. For stiff terms, we
apply implicit relaxation with subcycled updates
\begin{align}
U^* &= U^n + \Delta t L(U^n), \\
U^{n+1} &= U^* + \Delta t S(U^{n+1}).
\end{align}

\subsection{Primitive Recovery}
Primitive recovery solves for $(\rho, p, v_i)$ given the conservative
state. RMHD recovery uses iterative inversion with fallback strategies
\cite{noble2006}.

\subsection{Floors, Caps, and Stability Controls}
Density and pressure floors enforce positivity. Velocity caps limit $v$
close to $c$ to avoid numerical blow-up. These controls are configurable
and can be tightened during early testing.

\section{Algorithm Summary}
A single timestep proceeds as:
\begin{enumerate}
  \item Apply boundary conditions and nozzle inflow.
  \item Reconstruct primitives to faces (MUSCL/PPM/WENO).
  \item Solve Riemann problems at faces and compute fluxes.
  \item Update conserved variables with flux divergence.
  \item Apply source terms (gravity, GLM damping, dissipation, chemistry).
  \item Recover primitives and enforce floors/caps.
  \item Write diagnostics and outputs as configured.
\end{enumerate}

\section{Boundary Conditions and Injection}
Jet inflow is imposed at the x-min boundary with configurable nozzle
profiles (top-hat, taper, parabolic) and optional perturbations to seed
instabilities. The nozzle includes a shear layer of configurable
thickness and optional magnetic fields (poloidal or toroidal) at the
inlet.

\section{Diagnostics}
Diagnostics include maximum Lorentz factor, inlet energy and momentum
fluxes, centerline profiles, divB statistics, SN shock radius and gain
mass, cocoon pressure, mixing layer thickness, and optional performance
counters. Diagnostics are written as CSV files in each run directory.

\section{Verification and Validation}
We track qualitative stability and quantitative thresholds in validation
scripts. Error norms are defined as
\begin{align}
L_1 &= \frac{1}{N} \sum_i |u_i - u_i^{\mathrm{ref}}|, \\
L_2 &= \left(\frac{1}{N} \sum_i (u_i - u_i^{\mathrm{ref}})^2\right)^{1/2}, \\
L_\infty &= \max_i |u_i - u_i^{\mathrm{ref}}|,
\end{align}
with an observed convergence rate
\begin{equation}
\mathcal{P} = \frac{\log(L(h_1)/L(h_2))}{\log(h_1/h_2)}.
\end{equation}
Validation suites cover reconstruction and limiter behavior, Riemann
solver checks, GR Kerr-Schild runs, orthonormal flux evaluation, restart
regression, and SN-lite tests (freefall, Sedov, stalled shock, and
lightbulb heating). These tests are automated in \texttt{tools/}.

\section{Configuration and Reproducibility}
All physics and numerics options are set through JSON configuration
files. Outputs are organized by timestamp under \texttt{results/}. The
code records diagnostics in CSV for post-processing and comparison.

\subsection{Recommended Configuration Table}
Table \ref{tab:config-summary} lists a compact reference of commonly
used configuration switches and suggested values for jets and SN-lite.

\begin{table}[ht]
\centering
\begin{tabular}{l l l}
\hline
Key & Jet default & SN-lite default \\
\hline
PHYSICS & rmhd & sn \\
RECON & ppm & muscl \\
RIEMANN & hlld\_full & hlle \\
RK\_ORDER & 3 & 2 \\
GLM\_CH, GLM\_CP & 1.0, 0.1 & n/a \\
TWO\_TEMPERATURE & true & true \\
CHEMISTRY\_ENABLED & true & true \\
RESISTIVE\_ENABLED & false & false \\
NEUTRINO\_ENABLED & false & true \\
\hline
\end{tabular}
\caption{Compact configuration reference for typical jet and SN-lite runs.}
\label{tab:config-summary}
\end{table}

\section{Example Workflows and Results}
This section includes example figures and a compact diagnostics summary
table generated from the latest validation run. The figures can be
regenerated with \texttt{tools/make\_doc\_figures.py}.

\subsection{Jet Propagation Snapshot}
\begin{figure}[ht]
\centering
\includegraphics[width=0.9\linewidth]{figures/jet_rho_midZ.png}
\caption{Jet density slice at mid-Z from the latest run.}
\end{figure}

\subsection{Centerline Lorentz Factor}
\begin{figure}[ht]
\centering
\includegraphics[width=0.9\linewidth]{figures/centerline_gamma.png}
\caption{Centerline Lorentz factor profile from the latest run.}
\end{figure}

\subsection{RMHD divB Control}
\begin{figure}[ht]
\centering
\includegraphics[width=0.9\linewidth]{figures/divb_max.png}
\caption{divB max over time from the latest RMHD run segment.}
\end{figure}

\subsection{SN-lite Shock Evolution}
\begin{figure}[ht]
\centering
\includegraphics[width=0.9\linewidth]{figures/sn_shock_radius.png}
\caption{SN-lite shock radius evolution from the latest run segment.}
\end{figure}

\subsection{Diagnostics Summary Table}
\input{figures/validation_summary.tex}

\appendix
\section{Configuration Parameters}
Tables in this section list the default configuration keys from
\texttt{utils/settings.py}. Units are code units unless stated otherwise.

\small
\setlength{\tabcolsep}{4pt}
\begin{longtable}{p{0.28\linewidth} p{0.12\linewidth} p{0.5\linewidth}}
\hline
Key & Default & Notes \\
\hline
\endfirsthead
\hline
Key & Default & Notes \\
\hline
\endhead
\multicolumn{3}{l}{\textbf{Grid and Numerics}} \\
NX & 128 & Grid cells in x. \\
NY & 96 & Grid cells in y. \\
NZ & 96 & Grid cells in z. \\
Lx & 1.0 & Domain length in x. \\
Ly & 1.0 & Domain length in y. \\
Lz & 1.0 & Domain length in z. \\
T\_END & 0.25 & End time. \\
OUT\_EVERY & 50 & Output cadence in steps. \\
PRINT\_EVERY & 10 & Log cadence in steps. \\
NG & 2 & Ghost zones per side. \\
CFL & 0.35 & Courant number. \\
GAMMA & 5/3 & Ideal-gas gamma (SRHD/RMHD). \\
HALO\_EXCHANGE & blocking & MPI halo exchange mode. \\
RECON & muscl & Reconstruction (muscl/ppm/weno). \\
LIMITER & mc & Slope limiter for MUSCL. \\
RIEMANN & hlle & Riemann solver (hlle/hllc/hlld/hlld\_full). \\
RK\_ORDER & 2 & SSPRK order (2 or 3). \\
CHECKPOINT\_EVERY & 0 & Checkpoint cadence (0 disables). \\
RESTART\_PATH & null & Path to restart checkpoint. \\
\multicolumn{3}{l}{\textbf{Adaptivity and Threading}} \\
ADAPTIVITY\_ENABLED & false & Static nested refinement (single rank). \\
ADAPTIVITY\_MODE & nested\_static & Refinement mode. \\
\makecell[l]{ADAPTIVITY\\\_REFINEMENT} & 2 & Refinement factor. \\
ADAPTIVITY\_REGION & null & Refinement region [xlo,xhi,ylo,yhi,zlo,zhi]. \\
ADAPTIVITY\_SUBCYCLES & null & Subcycling steps (optional). \\
NUMBA\_NUM\_THREADS & null & Numba thread override. \\
OMP\_NUM\_THREADS & null & OpenMP thread override. \\
\multicolumn{3}{l}{\textbf{Jet Nozzle and Ambient}} \\
JET\_RADIUS & 0.12 & Jet radius. \\
JET\_CENTER & null & Jet center (defaults to mid y/z). \\
GAMMA\_JET & 6.0 & Jet Lorentz factor. \\
ETA\_RHO & 0.05 & Jet-to-ambient density ratio. \\
P\_EQ & 1.0e-2 & Jet/ambient equilibrium pressure. \\
SHEAR\_THICK & 0.02 & Shear layer thickness. \\
NOZZLE\_TURB & true & Enable nozzle perturbations. \\
TURB\_VAMP & 0.02 & Velocity perturbation amplitude. \\
TURB\_PAMP & 0.0 & Pressure perturbation amplitude. \\
NOZZLE\_PROFILE & top\_hat & top\_hat/taper/parabolic. \\
NOZZLE\_PERTURB & null & random/sinusoidal. \\
RHO\_AMB & 1.0 & Ambient density. \\
P\_AMB & null & Ambient pressure (defaults to P\_EQ). \\
VX\_AMB & 0.0 & Ambient velocity x. \\
VY\_AMB & 0.0 & Ambient velocity y. \\
VZ\_AMB & 0.0 & Ambient velocity z. \\
P\_MAX & 1.0 & Pressure cap for stability. \\
V\_MAX & 0.999 & Velocity cap for stability. \\
\multicolumn{3}{l}{\textbf{RMHD and GR Controls}} \\
PHYSICS & hydro & hydro/rmhd/grhd/grmhd/sn. \\
GLM\_CH & 1.0 & GLM hyperbolic cleaning speed. \\
GLM\_CP & 0.1 & GLM damping coefficient. \\
B\_INIT & none & none/poloidal/toroidal. \\
B0 & 0.0 & Reference magnetic field magnitude. \\
GR\_METRIC & minkowski & minkowski/schwarzschild/kerr-schild. \\
GR\_MASS & 1.0 & Metric mass parameter. \\
GR\_SPIN & 0.0 & Metric spin parameter. \\
ORTHONORMAL\_FLUX & true & Orthonormal-frame flux evaluation. \\
\multicolumn{3}{l}{\textbf{Dissipation}} \\
DISSIPATION\_ENABLED & false & Enable causal dissipation. \\
DISSIPATION\_MODEL & \makecell[l]{israel\\\_stewart} & Dissipation model. \\
RELAX\_TAU & 0.1 & Global relaxation time. \\
BULK\_ZETA & 0.0 & Bulk viscosity coefficient. \\
SHEAR\_ETA & 0.0 & Shear viscosity coefficient. \\
HEAT\_KAPPA & 0.0 & Heat conductivity coefficient. \\
RELAX\_TAU\_BULK & null & Bulk relaxation time override. \\
RELAX\_TAU\_SHEAR & null & Shear relaxation time override. \\
RELAX\_TAU\_HEAT & null & Heat relaxation time override. \\
DISSIPATION\_CAP\_FRAC & 0.5 & Maximum fractional update. \\
DISSIPATION\_ADVECT & true & Advect dissipative fields. \\
DISSIPATION\_SUBCYCLES & 1 & IMEX subcycles per step. \\
\makecell[l]{DISSIPATION\\\_SUBCYCLES\\\_AUTO} & true & Auto subcycle selection. \\
\makecell[l]{DISSIPATION\\\_SUBCYCLES\\\_MAX} & 32 & Maximum subcycles. \\
\makecell[l]{DISSIPATION\\\_SUBCYCLE\\\_FRACTION} & 0.5 & Subcycle timestep fraction. \\
\multicolumn{3}{l}{\textbf{Tracers and Chemistry}} \\
N\_TRACERS & 0 & Number of passive tracers. \\
TRACER\_NAMES & null & Optional tracer names list. \\
TRACER\_NOZZLE\_VALUES & null & Nozzle tracer values. \\
TRACER\_AMB\_VALUES & null & Ambient tracer values. \\
CHEMISTRY\_ENABLED & false & Enable H/He network. \\
CHEM\_X & 0.76 & Hydrogen mass fraction. \\
CHEM\_Y & 0.24 & Helium mass fraction. \\
CHEM\_TUNIT\_K & 1.0e4 & Temperature unit in K. \\
CHEM\_RATE\_SCALE & 1.0 & Rate scaling factor. \\
CHEM\_ENERGY\_SCALE & 1.0 & Energy coupling scale. \\
CHEM\_TMIN\_K & 1.0 & Temperature floor in K. \\
CHEM\_X\_HII\_AMB & 0.0 & Ambient HII fraction. \\
CHEM\_X\_HEII\_AMB & 0.0 & Ambient HeII fraction. \\
CHEM\_X\_HEIII\_AMB & 0.0 & Ambient HeIII fraction. \\
CHEM\_X\_HII\_NOZZLE & null & Nozzle HII fraction. \\
CHEM\_X\_HEII\_NOZZLE & null & Nozzle HeII fraction. \\
CHEM\_X\_HEIII\_NOZZLE & null & Nozzle HeIII fraction. \\
\multicolumn{3}{l}{\textbf{Two-Temperature and Cooling}} \\
TWO\_TEMPERATURE & false & Enable two-temperature model. \\
TEI\_TAU & 0.5 & Electron-ion relaxation time. \\
TE\_AMB & null & Ambient electron temperature. \\
TI\_AMB & null & Ambient ion temperature. \\
TE\_NOZZLE & null & Nozzle electron temperature. \\
TI\_NOZZLE & null & Nozzle ion temperature. \\
COOLING\_ENABLED & false & Enable cooling/heating. \\
COOLING\_LAMBDA & 0.0 & Cooling coefficient. \\
HEATING\_RATE & 0.0 & Uniform heating rate. \\
\multicolumn{3}{l}{\textbf{Resistive and Non-Ideal MHD}} \\
RESISTIVE\_ENABLED & false & Enable resistive RMHD. \\
RESISTIVITY & 0.0 & Resistivity coefficient. \\
\makecell[l]{NONIDEAL\\\_MHD\\\_ENABLED} & false & Enable non-ideal terms. \\
HALL\_ENABLED & false & Enable Hall term. \\
HALL\_COEFF & 0.0 & Hall coefficient. \\
AMBIPOLAR\_ENABLED & false & Enable ambipolar term. \\
AMBIPOLAR\_COEFF & 0.0 & Ambipolar coefficient. \\
HYPERRESIST\_ENABLED & false & Enable hyper-resistive term. \\
HYPERRESIST\_COEFF & 0.0 & Hyper-resistive coefficient. \\
JOULE\_HEAT\_ENABLED & false & Enable Joule heating. \\
JOULE\_HEAT\_EFF & 0.0 & Joule heating efficiency. \\
\multicolumn{3}{l}{\textbf{Radiation and Kinetic Effects}} \\
\makecell[l]{RADIATION\\\_COUPLING\\\_ENABLED} & false & Enable radiation coupling. \\
RADIATION\_COEFF & 0.0 & Coupling coefficient. \\
RADIATION\_T\_RAD & 0.0 & Radiation temperature. \\
\makecell[l]{RADIATION\\\_COUPLING\\\_TARGET} & gas & gas/electron target. \\
\makecell[l]{KINETIC\\\_EFFECTS\\\_ENABLED} & false & Enable kinetic heating. \\
KINETIC\_MODEL & shear & Kinetic model choice. \\
KINETIC\_COEFF & 0.0 & Kinetic coefficient. \\
KINETIC\_CAP & 0.0 & Kinetic cap. \\
\multicolumn{3}{l}{\textbf{SN-lite Gravity and Heating}} \\
SN\_GRAVITY\_ENABLED & false & Enable SN gravity. \\
SN\_GRAVITY\_MODEL & point\_mass & point\_mass/monopole/monopole\_plus\_point. \\
SN\_GRAVITY\_MASS & 1.0 & Point mass. \\
SN\_GRAVITY\_G & 1.0 & Gravitational constant. \\
SN\_GRAVITY\_SOFTEN & 0.01 & Softening length. \\
SN\_GRAVITY\_BINS & 64 & Monopole bins. \\
\makecell[l]{SN\\\_GRAVITY\\\_UPDATE\\\_EVERY} & 1 & Monopole update cadence. \\
SN\_GRAVITY\_CENTER & null & Gravity center. \\
SN\_GRAVITY\_ENERGY & false & Couple gravity to energy. \\
SN\_HEATING\_ENABLED & false & Enable gain heating/cooling. \\
SN\_HEATING\_MODEL & \makecell[l]{gain\\\_spherical} & gain model. \\
SN\_HEATING\_RATE & 0.0 & Heating rate. \\
SN\_COOLING\_RATE & 0.0 & Cooling rate. \\
SN\_GAIN\_RADIUS & 0.2 & Gain radius. \\
SN\_GAIN\_WIDTH & 0.1 & Gain width. \\
SN\_GAIN\_POW & 2.0 & Gain power-law exponent. \\
SN\_HEATING\_RHO\_EXP & 0.0 & Density exponent. \\
SN\_HEATING\_P\_EXP & 0.0 & Pressure exponent. \\
SN\_HEATING\_TIME\_TAU & 0.0 & Heating decay timescale. \\
SN\_HEATING\_TIME\_T0 & 0.0 & Heating decay start time. \\
SN\_COOLING\_TEXP & 0.0 & Cooling temperature exponent. \\
SN\_COOLING\_TREF & 1.0 & Cooling temperature reference. \\
SN\_SHOCK\_P\_RATIO & 1.2 & Shock detection pressure ratio. \\
SN\_SHOCK\_P\_REF & null & Shock detection reference pressure. \\
\multicolumn{3}{l}{\textbf{Neutrino Lightbulb}} \\
NEUTRINO\_ENABLED & false & Enable neutrino lightbulb. \\
NEUTRINO\_MODEL & lightbulb & Lightbulb model. \\
NEUTRINO\_LUM & 0.0 & Neutrino luminosity. \\
NEUTRINO\_EPS & 1.0 & Neutrino energy scale. \\
NEUTRINO\_KAPPA & 0.0 & Opacity coefficient. \\
NEUTRINO\_ABS\_COEFF & 0.0 & Absorption coefficient. \\
NEUTRINO\_COOL\_COEFF & 0.0 & Cooling coefficient. \\
NEUTRINO\_COOL\_TEXP & 6.0 & Cooling temperature exponent. \\
NEUTRINO\_R0 & 0.0 & Lightbulb radius. \\
NEUTRINO\_R1 & 0.0 & Lightbulb width. \\
NEUTRINO\_TAU\_FLOOR & 0.0 & Optical depth floor. \\
NEUTRINO\_TIME\_TAU & 0.0 & Lightbulb decay timescale. \\
NEUTRINO\_TIME\_T0 & 0.0 & Lightbulb decay start time. \\
\multicolumn{3}{l}{\textbf{SN-lite EOS and Initialization}} \\
SN\_EOS\_GAMMA & 4/3 & SN EOS gamma. \\
EOS\_MODE & gamma & gamma/piecewise/table. \\
EOS\_PIECEWISE\_RHO & null & Density breaks for piecewise gamma. \\
EOS\_PIECEWISE\_GAMMA & null & Gamma values for piecewise EOS. \\
EOS\_GAMMA\_TABLE\_RHO & null & Density table for gamma(rho). \\
EOS\_GAMMA\_TABLE\_VAL & null & Gamma table values. \\
EOS\_TABLE\_LOG & true & Log-space interpolation. \\
SN\_COMP\_NAMES & null & SN composition names. \\
SN\_COMP\_AMB\_VALUES & null & Ambient composition values. \\
\makecell[l]{SN\\\_COMP\\\_NOZZLE\\\_VALUES} & null & Nozzle composition values. \\
SN\_INIT & uniform & SN initial condition. \\
SN\_SEDOV\_RADIUS & 0.05 & Sedov blast radius. \\
SN\_SEDOV\_DP & 1.0 & Sedov pressure jump. \\
SN\_SPHERE\_RADIUS & 0.2 & SN sphere radius. \\
SN\_RHO\_IN & 1.0 & Inner density. \\
SN\_RHO\_OUT & 0.1 & Outer density. \\
SN\_P\_IN & 1.0 & Inner pressure. \\
SN\_P\_OUT & 0.01 & Outer pressure. \\
\multicolumn{3}{l}{\textbf{Results, Debug, and Diagnostics}} \\
RESULTS\_UNIQUE & false & Use unique results subdir. \\
SAVE\_RUN\_CONFIG & true & Save run config in results. \\
DEBUG & false & Debug logging. \\
ASSERTS & false & Enable runtime asserts. \\
CHECK\_NAN\_EVERY & 0 & NaN check cadence. \\
PERF\_ENABLED & false & Performance logging. \\
PERF\_EVERY & 10 & Performance cadence. \\
PERF\_RESET\_EVERY & 0 & Performance reset cadence. \\
DIAG\_COCOON\_ENABLED & false & Cocoon diagnostics. \\
\makecell[l]{DIAG\\\_COCOON\\\_TRACER\\\_IDX} & 0 & Tracer index for cocoon. \\
\makecell[l]{DIAG\\\_COCOON\\\_TRACER\\\_MIN} & 0.05 & Cocoon tracer min. \\
\makecell[l]{DIAG\\\_COCOON\\\_TRACER\\\_MAX} & 1.0 & Cocoon tracer max. \\
DIAG\_MIXING\_ENABLED & false & Mixing diagnostics. \\
\makecell[l]{DIAG\\\_MIXING\\\_TRACER\\\_IDX} & 0 & Tracer index for mixing. \\
DIAG\_MIXING\_MIN & 0.05 & Mixing tracer min. \\
DIAG\_MIXING\_MAX & 0.95 & Mixing tracer max. \\
DIAG\_MIXING\_X\_FRAC & 0.5 & Mixing midplane fraction. \\
RESTART\_STRICT & false & Strict restart validation. \\
\hline
\end{longtable}
\normalsize
\setlength{\tabcolsep}{6pt}

\section{Paper Template Checklist}
\subsection{Recommended Figures}
\begin{itemize}
  \item Jet density slice and Lorentz factor centerline profile.
  \item RMHD divB control over time for representative runs.
  \item Shock radius evolution for SN-lite scenarios.
  \item Resolution study comparing MUSCL/PPM/WENO convergence.
  \item GR metric validation plots (e.g., Kerr-Schild test case).
\end{itemize}

\subsection{Recommended Tables}
\begin{itemize}
  \item Configuration summary for each experiment class.
  \item Diagnostics summary (max Gamma, divB, shock radius).
  \item Convergence errors for scheme comparisons.
\end{itemize}

\subsection{Results Checklist}
\begin{itemize}
  \item State the EOS, reconstruction, Riemann solver, and time integrator.
  \item Report CFL, grid resolution, and runtime stability settings.
  \item Provide divB statistics for RMHD/GRMHD runs.
  \item Report shock radius and heating efficiency for SN-lite runs.
  \item Include convergence or resolution-sensitivity tests.
  \item Archive configs and diagnostics alongside plots.
\end{itemize}

\section{Limitations and Future Work}
Current limitations include static nested refinement (single rank),
limited GRMHD benchmark coverage, and incomplete GPU acceleration for
solver kernels. Planned improvements include expanded EOS options,
quantitative convergence tests, and additional validation problems.

\bibliographystyle{unsrt}
\bibliography{astrofd_refs}

\end{document}
